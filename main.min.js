let Wc=1,Wa=1,xMath=0,gX="a * x**2",a=1,loadingBlock=document.querySelector(".loading");function addLoading(e){e.classList.add("active"),setTimeout(()=>{e.classList.add("visible")},10)}function closeLoading(e){e.classList.remove("visible"),setTimeout(()=>{e.classList.remove("active")},300)}function start(){let mainFormula="Wc * Wa * Math.exp(-Wa*x-Wc*Math.exp(-Wa*x))".replace(/Math.exp/g,"sp.exp").replace(/Wa/g,"a").replace(/Wc/g,"c");function We(e){return Wc*Wa*Math.exp(-Wa*e-Wc*Math.exp(-Wa*e))}let WeAjax="",dif="";function secondStart(){const inputElementsStart=document.querySelectorAll(".graphSize_start"),inputValuesStart=Array.from(inputElementsStart).map(e=>""==e.value?-10:Number(e.value)),inputElementsStop=document.querySelectorAll(".graphSize_stop"),inputValuesStop=Array.from(inputElementsStop).map(e=>""==e.value?10:Number(e.value));function WeAjaxFunction(x){return eval(WeAjax)}function difEvalFunc(x){return eval(dif)}function createChart(e,a,t,r="Y",n=0){var l=am4core.create(e,am4charts.XYChart),i=l.xAxes.push(new am4charts.ValueAxis);i.renderer.minGridDistance=1,i.title.text=0==n?"":t;var c=l.yAxes.push(new am4charts.ValueAxis);c.renderer.minGridDistance=20,c.title.text=r;var u=l.series.push(new am4charts.LineSeries);return u.dataFields.valueY="y",u.dataFields.valueX="x",u.name=a,u.tooltipText=t,l}var chart1=createChart("chartdiv1","X","X: [bold]{y}[/]","F(X)"),chart2=createChart("chartdiv2","Y","X: [bold]{y}[/]","F(Y)"),chart3=createChart("chartdiv3","Y","X: [bold]{y}[/]","W(Y)");const resultMath=integrate(e=>e*We(e),0,60),resultMath2=integrate(e=>e*e*We(e),0,60),resultMath3=integrate(e=>(e-resultMath)*(e-resultMath)*We(e),0,60);function generateyData(e,a,t){for(var r=[],n=e;n<a;n+=.1){var l=t(n);r.push({x:n,y:l})}return r}document.querySelector(".first_1").innerHTML=parseFloat(resultMath.toFixed(3)),document.querySelector(".first_2").innerHTML=parseFloat(resultMath2.toFixed(3)),document.querySelector(".first_3").innerHTML=parseFloat(resultMath3.toFixed(3));var data1=generateyData(inputValuesStart[0],inputValuesStop[0],e=>WeAjaxFunction(e)),data2=generateyData(inputValuesStart[1],inputValuesStop[1],e=>WeAjaxFunction(e)),data3=generateyData(inputValuesStart[2],inputValuesStop[2],e=>difEvalFunc(e));let graphFormuls=document.querySelectorAll(".graphFormul");graphFormuls[0].innerHTML=WeAjax.replace(/Math./g,""),graphFormuls[1].innerHTML=WeAjax.replace(/x/g,"y").replace(/eyp/g,"exp").replace(/Math./g,""),document.querySelector(".graphFormul_2").innerHTML=graphFormuls[1].innerHTML,graphFormuls[2].innerHTML=dif.replace(/x/g,"y").replace(/eyp/g,"exp").replace(/Math./g,""),chart1.series.values[0].data=data1,chart2.series.values[0].data=data2,chart3.series.values[0].data=data3,chart1.legend=new am4charts.Legend,chart2.legend=new am4charts.Legend,chart3.legend=new am4charts.Legend;let thirdGraphs=document.querySelectorAll(".thirdhFormul"),m_η=integrate(e=>e*difEvalFunc(e),0,60).toFixed(3),σ_η=integrate(e=>e*e*difEvalFunc(e),0,60).toFixed(3),σσ_η=integrate(e=>(e-m_η)*(e-m_η)*difEvalFunc(e),0,60).toFixed(3);thirdGraphs[0].innerHTML=parseFloat(m_η),thirdGraphs[1].innerHTML=parseFloat(σ_η),thirdGraphs[2].innerHTML=parseFloat(σσ_η),closeLoading(loadingBlock)}$.ajax({url:"./vendor/integral.php",method:"post",data:{text:JSON.stringify(mainFormula),a:Wa,c:Wc},success:function(e){WeAjax=e.replace(/exp/g,"Math.exp"),$.ajax({url:"./vendor/dif.php",method:"post",data:{text:JSON.stringify(WeAjax.replace(/Math.exp/g,"sp.exp")),a:Wa,c:Wc},success:function(e){dif=e.replace(/exp/g,"Math.exp"),secondStart()}})}})}start(),document.querySelector("button").addEventListener("click",()=>{addLoading(loadingBlock);const e=document.querySelectorAll("input");Wa=""==e[0].value?1:Number(e[0].value),Wc=""==e[1].value?1:Number(e[1].value),start()});